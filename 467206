import pandas as pd
import numpy as np
df=pd.read_csv('sales1.csv',engine="python")

print(df)
list = df['Price'] * df['Qty']
df['FPrice'] = list
print(df)
def totalsale():
    total_sale = df['FPrice'].sum()
    print('TOTAL SALE=', total_sale)
def itemsold():
    items_sold = df['Qty'].sum()
    print('ITEMS SOLD', items_sold)
def avgsale():
    total_sale = df['FPrice'].sum()
    items_sold = df['Qty'].sum()
    avg_sale = total_sale/items_sold
    print('AVERAGE SALE', avg_sale)
def topfivesalesbyprice():
    prod_sales = pd.DataFrame(df.groupby('Item_Name').sum()['FPrice'])
    # Top 5 sales ie By Price
    prod_sales.sort_values(by=['FPrice'], inplace=True, ascending=False)
    top_prods = prod_sales.head(5)
    print('TOP 5 SALES BY PRICE', top_prods)
def mostsellingproducts():
    # Most selling products ie More Quantity
    best_selling_prods = pd.DataFrame(df.groupby('Item_Name').sum()['Qty'])
    best_selling_prods.sort_values(by=['Qty'], inplace=True, ascending=False)
    best_selling_prods = best_selling_prods.head(5)
    print('MOST SELLING PRODUCTS', best_selling_prods)
def revenueperitem():
    print('REVENUE PER ITEM')
    x = pd.DataFrame(df.groupby('Item_Name').sum()['FPrice'])
    print(x)
def revenuepercat():
    print('REVENUE PER CATEGORY')
    x = pd.DataFrame(df.groupby('Item_Category').sum()['FPrice'])
    print(x)
def revenuepercustomer():
    print('REVENUE PER CUSTOMER')
    mostvalcus = pd.DataFrame(df.groupby('Customer').sum()['FPrice'])
    print(mostvalcus)
def mostvaluablecustomer():
     mostvalcus = pd.DataFrame(df.groupby('Customer').sum()['FPrice'])
     mostvalcus.sort_values(by=['FPrice'], inplace=True, ascending=False)
     mostvalcus = mostvalcus.head(1)
     print("MOST VALUABLE CUSTOMER=",mostvalcus)